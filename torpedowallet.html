<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TORPEDO NFT Manager - SmartBCH</title>

<!-- <meta property="og:image" content="https://ba.net/pony/icon-small.png"> -->

    <link rel="stylesheet" type="text/css" href="torpedowallet_files/bootstrap.css">

    <script src="torpedowallet_files/web3.js" integrity="sha512-96ZCo0pzD4x2MuBZCB4ipirFKs/X/xB2diGU/A7zpfaltISM309KN79pyWe4l9IdtOlzitRltfVcxgdTEbcnvQ==" crossorigin="anonymous"></script>
    <!--script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"--><!--/script-->
<script src="torpedowallet_files/jquery-3.js"></script>
    <script src="torpedowallet_files/bootstrap.js"></script>
</head>

<body>
<style>
        body {
               background: #F5F0F2;
}
</style>

    <div class="container">
<center>
<p><br>
</p><table cellpadding="10"><tbody><tr><td>
<a href="https://ba.net/smartbch/metamask.html" target="_blank">
<img src="torpedowallet_files/metamask2.png" title="install metamask extension" width="45" height="45" border="0" align="left">
</a>
</td><td>
<a href="https://ba.net/smartbch/metamask.html" target="_blank">
<img src="torpedowallet_files/smartbch2.png" title="smartbch metamask config" width="45" height="45" border="0" align="left">
</a>
</td><td>
<a href="https://ba.net/amkt-smartbch/business.html">
<img src="torpedowallet_files/shop-small.png" width="45" height="45" border="0" align="left"></a>
</td><td>
<a href="https://ba.net/amkt-smartbch">
<img src="torpedowallet_files/torpedo1.png" title="TORPEDO NFT Exchange" width="115" height="115" border="0" align="left">
</a>

</td><td>
        <h3>TORPEDO NFT Manager</h3>
SmartBCH
</td></tr></tbody></table>
<p><br>



       </p><div class="mb-3">


<p><br><br>

<button id="button4" class="btn btn-secondary">Connect Metamask</button>
</p><p><br><br>

        <button id="button2" class="btn btn-primary">View All TORPEDO NFTs</button>

</p><p>
</p><div class="mb-3">
<div id="lang">
</div>
</div>


<p><br>
</p><p><br>
</p><table>
<tbody><tr><td><label for="name" class="col-lg-2 form-label">TORPEDO ID</label>
</td><td><input id="ponyid" size="6" type="text" placeholder="123">

</td></tr><tr>
<td><label for="name" class="col-lg-2 form-label">Send To Address</label>
</td><td><input id="address" size="52" type="text" placeholder="0x...">
</td></tr></tbody></table>	    
</div>


<p><br>
        <button id="button" class="btn btn-primary">Transfer TORPEDO</button>


</p></center></div>

<center>

<p><br><br>
You can also view your Torpedo in the Metamask App for Mobile
<br>directly inside the collectible tab
<br>0x74d731274c6c4ce78e070357160255a2596da71d
<br>Copy Torpedo Token ID
<br>On Metamask Desktop
<br>Decimals 0

</p><p><br><br>
<font size="5">




</font></p><p><font size="5"><br><br>
</font></p><p><font size="5"><br><br>
</font></p><p><font size="5"><br><br>

<font size="4">

</font></font></p><p><font size="5"><font size="4"><br><br>


<br><br>


    <script>

web3 = new Web3(web3.currentProvider);
//ethereum.enable();

//no auto connect
//ethereum.request({ method: 'eth_requestAccounts' });

        if (typeof web3 !== 'undefined') {
            console.log("Using current provider")
            web3 = new Web3(web3.currentProvider);
        } else {
            // set the provider you want from Web3.providers
            web3 = new Web3(new Web3.providers.HttpProvider("https://smartbch.greyh.at"));
//            console.log("Using ganache (localhost)");
        }
</script>

<script src="torpedowallet_files/contract.js"></script>

<script>
        var cuentaMaster;
        const getAccount = async () => {
            try {
                const myAccounts = await web3.eth.getAccounts();
                cuentaMaster = myAccounts[0];
                console.log("Master account " + cuentaMaster);
                return myAccounts[0];

            } catch (err) {
                console.log(err);
            }
        }

        getAccount();
        web3.eth.defaultAccount = web3.eth.accounts[0];


        $("#button4").click(function () {
            console.log("Master = " + cuentaMaster);

//force login ok
ethereum.request({ method: 'eth_requestAccounts' });

        if (typeof web3 !== 'undefined') {
            console.log("Using current provider")
            web3 = new Web3(web3.currentProvider);
        } else {
            // set the provider you want from Web3.providers
            web3 = new Web3(new Web3.providers.HttpProvider("https://smartbch.greyh.at"));
//            console.log("Using ganache (localhost)");
        }


})



        $("#button2").click(function () {

if (!cuentaMaster) {
document.getElementById('button4').click();
location.reload(true);
}

$("#lang").html(content);
var content = "";

for(x = 1; x < 100; x++){

counter=1;
contract.methods.tokenURI(x).call()
                .then(function (result) {

content += "<a href=" + result + " target=_blank> NFT "+counter.toString()+"</a>";
$("#lang").html(content);
counter++;

}); // tokenURI

contract.methods.ownerOf(x).call()
	       .then(function (result1) {

if (result1 == cuentaMaster) content += " <== Owned by your address!<br> ";
$("#lang").html(content);

}); // ownerOf


}; // for loop


}); // button2




        $("#button").click(function () {
            console.log("Master = " + cuentaMaster);
            var ponyid = $("#ponyid").val();
            var address = $("#address").val();


//if not connected reload page
if (!cuentaMaster) location.reload(true);

var content = "<p><br>Sending transaction...";
$("#lang").html(content);

var event = contract.methods.safeTransferFrom(cuentaMaster,address, ponyid).send({ from: cuentaMaster, gasPrice: 1050000000 })
                .then(function (receipt) {
                    // will be fired once the receipt is mined
                    console.log(receipt);
//alert(JSON.stringify(receipt));

var content = "<p><br><br>Transaction sent!<br>";
content += JSON.stringify(receipt.transactionHash);
//document.write(content);
$("#lang").html(content);

                });;

        });







    </script>




</font></font></p></center></body></html>